<!--
 * @Description: 
 * @Version: 1.0
 * @Author: Li Yuanhao
 * @Email: dalao_li@163.com
 * @Date: 2021-03-11 08:59:41
 * @LastEditors: Li Yuanhao
 * @LastEditTime: 2021-03-11 09:54:17
-->

## 并发

- 顺序执行

![](https://cdn.hurra.ltd/img/20210311091516.png)

- 并发执行

shell不支持多线程,因而只能采用多进程的方式.

```sh
#!/bin/bash

for i in {1..10}
do
    echo $i &
done

wait
echo "END"
```

| 参数 | 含义                                              |
| ---- | ------------------------------------------------- |
| &    | 将命令转入后台,可在执行后不等其结束就执行下条命令 |
| wait | wait命令相当于其它高级语言里的多线程同步          |

![](https://cdn.hurra.ltd/img/20210311092339.png)


## 例

- 并发建立10个docker busy_box容器

```sh
#!/bin/bash

for i in {1..10}
do
    docker run -itd --name box_$i busybox /bin/sh  &
done

wait
echo "finished"
```

![](https://cdn.hurra.ltd/img/20210311093438.png)

- 查询当前网段下所有主机 

```sh
#!/bin/bash

for i in {1..254}
do
    ip="192.168.43.$i"
    ping -c 2 $ip &> /dev/null && echo $ip is up &
done

wait
```

| 参数         | 含义                                                         |
| ------------ | ------------------------------------------------------------ |
| &> /dev/null | 将标准/错误输出全部重定向到/dev/null中(将产生的所有信息丢弃) |

![](https://cdn.hurra.ltd/img/20210311093856.png)